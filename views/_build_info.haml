%h1&= build.human_status

- @build = build

%form{ :action => build_path(build), :method => :post }
  %p.submit
    %button{ :type => :submit, :title => "Rebuild this commit" }<
      Rebuild

%blockquote
  %p
    #{h(build.full_message).gsub("\n", '<br />')}
  %p.meta<
    %span.who<
      &== by: #{build.author}
    |
    %span.when{ :title => build.committed_at }<
      &= pretty_date build.committed_at
    - if build.project.github?
      |
      %span.github<
        %a{ :href => github_commit_url(build) } view on GitHub

- if build.completed?
  - if build.successful? && ! current_project.artifacts_empty?
    %h2
      Artifacts
      %blockquote
        %ul#artifacts
          - if ! current_project.artifacts_empty?
            - current_project.get_artifacts.each do |artifact|
              - if File.exists?("#{Integrity.config.directory}/#{@build.id}/#{artifact}")
                %a{ :title => "#{artifact}", :href => "#{root_url}artifacts/#{current_project.name.downcase}/#{@build.id}/#{artifact}" } #{artifact}
              - elsif artifact.include? "*"
                - Dir["#{Integrity.config.directory}/#{@build.id}/#{artifact}"].each do |wildcarded|
                  %a{ :title => "#{artifact}",
                      :href => "#{root_url}artifacts/#{current_project.name.downcase}/#{@build.id}/#{File.basename(wildcarded)}" } #{File.basename(wildcarded)}
          - elsif @project.artifacts_empty?
            %a{ :title => "No artifacts for this project :/" } No artifacts for this project :/

  %h2
    Build Output
    %a{:href => build_path(build, :raw)} (raw)
  
  %pre.output
    :preserve
      #{bash_color_codes h(build.output)}
